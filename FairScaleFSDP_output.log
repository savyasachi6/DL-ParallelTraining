[2025-03-29 15:01:17,027] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-29 15:01:17,050] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-29 15:01:17,052] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-29 15:01:17,053] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-29 15:01:17,140] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-29 15:01:17,140] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-29 15:01:17,140] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-03-29 15:01:17,143] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
SLURM_PROCID=7, SLURM_LOCALID=3, SLURM_NTASKS=8
SLURM_PROCID=1, SLURM_LOCALID=1, SLURM_NTASKS=8
SLURM_PROCID=2, SLURM_LOCALID=2, SLURM_NTASKS=8
SLURM_PROCID=6, SLURM_LOCALID=2, SLURM_NTASKS=8
SLURM_PROCID=3, SLURM_LOCALID=3, SLURM_NTASKS=8
SLURM_PROCID=5, SLURM_LOCALID=1, SLURM_NTASKS=8
SLURM_PROCID=0, SLURM_LOCALID=0, SLURM_NTASKS=8
SLURM_PROCID=4, SLURM_LOCALID=0, SLURM_NTASKS=8
Rank 0: Set device to cuda:0, GPU: Quadro RTX 5000
Rank 4: Set device to cuda:0, GPU: Quadro RTX 5000
Rank 0: Set MASTER_ADDR to c196-111 from SLURM_NODELIST
Rank 0: MASTER_PORT not set by SLURM, defaulting to '29500'
Rank 0: Initializing process group with world_size=8, MASTER_ADDR=c196-111, MASTER_PORT=29500
Rank 4: Set MASTER_ADDR to c196-111 from SLURM_NODELIST
Rank 4: MASTER_PORT not set by SLURM, defaulting to '29500'
Rank 4: Initializing process group with world_size=8, MASTER_ADDR=c196-111, MASTER_PORT=29500
Rank 7: Set device to cuda:3, GPU: Quadro RTX 5000
Rank 1: Set device to cuda:1, GPU: Quadro RTX 5000
Rank 6: Set device to cuda:2, GPU: Quadro RTX 5000
Rank 3: Set device to cuda:3, GPU: Quadro RTX 5000
Rank 2: Set device to cuda:2, GPU: Quadro RTX 5000
Rank 5: Set device to cuda:1, GPU: Quadro RTX 5000
Rank 2: Set MASTER_ADDR to c196-111 from SLURM_NODELIST
Rank 3: Set MASTER_ADDR to c196-111 from SLURM_NODELIST
Rank 3: MASTER_PORT not set by SLURM, defaulting to '29500'
Rank 2: MASTER_PORT not set by SLURM, defaulting to '29500'
Rank 2: Initializing process group with world_size=8, MASTER_ADDR=c196-111, MASTER_PORT=29500
Rank 3: Initializing process group with world_size=8, MASTER_ADDR=c196-111, MASTER_PORT=29500
Rank 6: Set MASTER_ADDR to c196-111 from SLURM_NODELIST
Rank 6: MASTER_PORT not set by SLURM, defaulting to '29500'
Rank 6: Initializing process group with world_size=8, MASTER_ADDR=c196-111, MASTER_PORT=29500
Rank 7: Set MASTER_ADDR to c196-111 from SLURM_NODELIST
Rank 7: MASTER_PORT not set by SLURM, defaulting to '29500'
Rank 7: Initializing process group with world_size=8, MASTER_ADDR=c196-111, MASTER_PORT=29500
Rank 1: Set MASTER_ADDR to c196-111 from SLURM_NODELIST
Rank 1: MASTER_PORT not set by SLURM, defaulting to '29500'
Rank 1: Initializing process group with world_size=8, MASTER_ADDR=c196-111, MASTER_PORT=29500
Rank 5: Set MASTER_ADDR to c196-111 from SLURM_NODELIST
Rank 5: MASTER_PORT not set by SLURM, defaulting to '29500'
Rank 5: Initializing process group with world_size=8, MASTER_ADDR=c196-111, MASTER_PORT=29500
Rank 1: Process group initialized
Rank 2: Process group initialized
Rank 3: Process group initialized
Rank 5: Process group initialized
Rank 0: Process group initialized
Rank 1: Setting up dataloaders with world_size=8
Rank 3: Setting up dataloaders with world_size=8
Rank 2: Setting up dataloaders with world_size=8
Rank 0: Setting up dataloaders with world_size=8
Rank 6: Process group initialized
Rank 7: Process group initialized
Rank 4: Process group initialized
Rank 5: Setting up dataloaders with world_size=8
Rank 6: Setting up dataloaders with world_size=8
Rank 7: Setting up dataloaders with world_size=8
Rank 4: Setting up dataloaders with world_size=8
Rank 5: Dataloaders initialized
Rank 6: Dataloaders initialized
Rank 7: Dataloaders initialized
Rank 4: Dataloaders initialized
Rank 2: Dataloaders initialized
Rank 0: Dataloaders initialized
Rank 3: Dataloaders initialized
Rank 1: Dataloaders initialized
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py:2562: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if data.storage().size() > 0:
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py:2562: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if data.storage().size() > 0:
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py:2562: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if data.storage().size() > 0:
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py:2562: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if data.storage().size() > 0:
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py:2562: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if data.storage().size() > 0:
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py:2562: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if data.storage().size() > 0:
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py:2562: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if data.storage().size() > 0:
Rank 0: Starting training with mode FairScaleFSDP
Rank 1: Starting training with mode FairScaleFSDP
Rank 3: Starting training with mode FairScaleFSDP
Rank 5: Starting training with mode FairScaleFSDP
Rank 6: Starting training with mode FairScaleFSDP
Rank 4: Starting training with mode FairScaleFSDP
Rank 2: Starting training with mode FairScaleFSDP
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/nn/data_parallel/fully_sharded_data_parallel.py:2562: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if data.storage().size() > 0:
Rank 7: Starting training with mode FairScaleFSDP
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 1, Batch 0, Loss: 2.3015
Rank 0: GPU Memory Allocated: 212.08 MiB
Rank 0: [FairScaleFSDP] Epoch 1, Batch 10, Loss: 2.2218
Rank 0: GPU Memory Allocated: 212.08 MiB
Rank 0: [FairScaleFSDP] Epoch 1, Batch 20, Loss: 2.1959
Rank 0: GPU Memory Allocated: 212.08 MiB
Rank 0: [FairScaleFSDP] Epoch 1, Loss: 2.2442
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 2, Batch 0, Loss: 2.1882
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 2, Batch 10, Loss: 2.2290
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 2, Batch 20, Loss: 2.2269
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 2, Loss: 2.2060
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 3, Batch 0, Loss: 2.2408
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 3, Batch 10, Loss: 2.1808
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 3, Batch 20, Loss: 2.1455
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 3, Loss: 2.1912
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Rank 0: [FairScaleFSDP] Epoch 4, Batch 0, Loss: 2.1852
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 4, Batch 10, Loss: 2.1220
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 4, Batch 20, Loss: 2.1530
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 4, Loss: 2.1519
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 5, Batch 0, Loss: 2.1562
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 5, Batch 10, Loss: 2.1333
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 5, Batch 20, Loss: 2.0520
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 5, Loss: 2.1147
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 6, Batch 0, Loss: 2.0984
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 6, Batch 10, Loss: 2.1122
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 6, Batch 20, Loss: 2.1184
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 6, Loss: 2.0860
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Rank 0: [FairScaleFSDP] Epoch 7, Batch 0, Loss: 2.0634
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 7, Batch 10, Loss: 2.1164
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 7, Batch 20, Loss: 2.1035
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 7, Loss: 2.0780
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 8, Batch 0, Loss: 2.0123
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 8, Batch 10, Loss: 2.0514
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 8, Batch 20, Loss: 1.9997
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 8, Loss: 2.0504
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 9, Batch 0, Loss: 2.0494
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 9, Batch 10, Loss: 2.0543
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 9, Batch 20, Loss: 2.0310
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 9, Loss: 2.0274
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 10, Batch 0, Loss: 1.9916
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 10, Batch 10, Loss: 2.0488
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 10, Batch 20, Loss: 2.0145
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 10, Loss: 2.0077
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 11, Batch 0, Loss: 1.9887
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 11, Batch 10, Loss: 1.9937
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 11, Batch 20, Loss: 2.0606
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 11, Loss: 1.9904
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 12, Batch 0, Loss: 2.0024
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 12, Batch 10, Loss: 1.9651
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 12, Batch 20, Loss: 2.0209
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 12, Loss: 1.9775
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 13, Batch 0, Loss: 1.9236
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Rank 0: [FairScaleFSDP] Epoch 13, Batch 10, Loss: 1.9598
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 13, Batch 20, Loss: 1.9436
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 13, Loss: 1.9512
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 14, Batch 0, Loss: 1.9681
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 14, Batch 10, Loss: 1.9223
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 14, Batch 20, Loss: 1.8818
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 14, Loss: 1.8960
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 15, Batch 0, Loss: 1.7998
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 15, Batch 10, Loss: 1.8282
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 15, Batch 20, Loss: 1.8363
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 15, Loss: 1.8516
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 16, Batch 0, Loss: 1.8158
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 16, Batch 10, Loss: 1.7592
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 16, Batch 20, Loss: 1.7963
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 16, Loss: 1.8315
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 17, Batch 0, Loss: 1.8504
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 17, Batch 10, Loss: 1.8361
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 17, Batch 20, Loss: 1.7731
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 17, Loss: 1.8103
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 18, Batch 0, Loss: 1.8152
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 18, Batch 10, Loss: 1.7933
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 18, Batch 20, Loss: 1.8286
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 18, Loss: 1.7908
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 19, Batch 0, Loss: 1.8023
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 19, Batch 10, Loss: 1.7589
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 19, Batch 20, Loss: 1.7668
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 19, Loss: 1.7737
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 20, Batch 0, Loss: 1.7560
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 20, Batch 10, Loss: 1.7243
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 20, Batch 20, Loss: 1.7426
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 20, Loss: 1.7567
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 21, Batch 0, Loss: 1.6911
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 21, Batch 10, Loss: 1.7479
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 21, Batch 20, Loss: 1.7227
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 21, Loss: 1.7410
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 22, Batch 0, Loss: 1.7280
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 22, Batch 10, Loss: 1.6746
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 22, Batch 20, Loss: 1.6995
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 22, Loss: 1.7244
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 23, Batch 0, Loss: 1.7014
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 23, Batch 10, Loss: 1.7300
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 23, Batch 20, Loss: 1.7203
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 23, Loss: 1.7209
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 24, Batch 0, Loss: 1.7291
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 24, Batch 10, Loss: 1.7317
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 24, Batch 20, Loss: 1.6853
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 24, Loss: 1.7165
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 25, Batch 0, Loss: 1.7106
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 25, Batch 10, Loss: 1.6800
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 25, Batch 20, Loss: 1.7223
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 25, Loss: 1.7057
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 26, Batch 0, Loss: 1.6935
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 26, Batch 10, Loss: 1.7066
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 26, Batch 20, Loss: 1.6779
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 26, Loss: 1.6855
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 27, Batch 0, Loss: 1.6739
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Rank 0: [FairScaleFSDP] Epoch 27, Batch 10, Loss: 1.6602
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 27, Batch 20, Loss: 1.7103
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 27, Loss: 1.6786
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 28, Batch 0, Loss: 1.7193
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 28, Batch 10, Loss: 1.6888
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 28, Batch 20, Loss: 1.6968
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 28, Loss: 1.6715
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 29, Batch 0, Loss: 1.6991
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 29, Batch 10, Loss: 1.6610
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 29, Batch 20, Loss: 1.6538
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 29, Loss: 1.6602
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 30, Batch 0, Loss: 1.6430
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 30, Batch 10, Loss: 1.6661
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 30, Batch 20, Loss: 1.6576
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 30, Loss: 1.6680
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 31, Batch 0, Loss: 1.7116
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 31, Batch 10, Loss: 1.7692
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 31, Batch 20, Loss: 1.7360
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 31, Loss: 1.7311
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 32, Batch 0, Loss: 1.7936
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 32, Batch 10, Loss: 1.7637
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 32, Batch 20, Loss: 1.7642
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 32, Loss: 1.7869
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Rank 0: [FairScaleFSDP] Epoch 33, Batch 0, Loss: 1.7924
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 33, Batch 10, Loss: 1.7538
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 33, Batch 20, Loss: 1.6847
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 33, Loss: 1.7354
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 34, Batch 0, Loss: 1.7470
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 34, Batch 10, Loss: 1.6996
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 34, Batch 20, Loss: 1.6989
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 34, Loss: 1.7073
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 35, Batch 0, Loss: 1.7027
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 35, Batch 10, Loss: 1.7390
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 35, Batch 20, Loss: 1.7751
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 35, Loss: 1.7338
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 36, Batch 0, Loss: 1.7409
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 36, Batch 10, Loss: 1.6907
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 36, Batch 20, Loss: 1.7232
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 36, Loss: 1.7143
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 37, Batch 0, Loss: 1.6568
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 37, Batch 10, Loss: 1.6729
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 37, Batch 20, Loss: 1.6684
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 37, Loss: 1.6828
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 38, Batch 0, Loss: 1.6664
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 38, Batch 10, Loss: 1.6844
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 38, Batch 20, Loss: 1.6966
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 38, Loss: 1.6731
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 39, Batch 0, Loss: 1.6740
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 39, Batch 10, Loss: 1.6614
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 39, Batch 20, Loss: 1.7061
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 39, Loss: 1.6672
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 40, Batch 0, Loss: 1.6351
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 40, Batch 10, Loss: 1.6949
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 40, Batch 20, Loss: 1.6495
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 40, Loss: 1.6841
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 41, Batch 0, Loss: 1.7265
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 41, Batch 10, Loss: 1.6567
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 41, Batch 20, Loss: 1.6393
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 41, Loss: 1.6662
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 42, Batch 0, Loss: 1.6456
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 42, Batch 10, Loss: 1.6350
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 42, Batch 20, Loss: 1.6748
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 42, Loss: 1.6593
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 43, Batch 0, Loss: 1.6621
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 43, Batch 10, Loss: 1.6522
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 43, Batch 20, Loss: 1.6476
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 43, Loss: 1.6435
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 44, Batch 0, Loss: 1.6120
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 44, Batch 10, Loss: 1.6611
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 44, Batch 20, Loss: 1.6023
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 44, Loss: 1.6291
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 45, Batch 0, Loss: 1.5997
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 45, Batch 10, Loss: 1.5557
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 45, Batch 20, Loss: 1.5974
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 45, Loss: 1.6202
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 46, Batch 0, Loss: 1.6184
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 46, Batch 10, Loss: 1.5960
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 46, Batch 20, Loss: 1.5932
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 46, Loss: 1.6162
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 47, Batch 0, Loss: 1.5965
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 47, Batch 10, Loss: 1.5859
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 47, Batch 20, Loss: 1.7206
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
Rank 0: [FairScaleFSDP] Epoch 47, Loss: 1.6337
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 48, Batch 0, Loss: 1.6419
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 48, Batch 10, Loss: 1.6185
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 48, Batch 20, Loss: 1.6848
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 48, Loss: 1.6425
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 49, Batch 0, Loss: 1.6127
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 49, Batch 10, Loss: 1.6304
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 49, Batch 20, Loss: 1.6479
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 49, Loss: 1.6405
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Rank 0: [FairScaleFSDP] Epoch 50, Batch 0, Loss: 1.6431
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 50, Batch 10, Loss: 1.6364
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 50, Batch 20, Loss: 1.5750
Rank 0: GPU Memory Allocated: 212.09 MiB
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/distributed_training/train.py:77: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/torch/distributed/c10d_logger.py:81: FutureWarning: `torch.distributed._all_gather_base` is a private function and will be deprecated. Please use `torch.distributed.all_gather_into_tensor` instead.
  return func(*args, **kwargs)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
/home1/10504/lfw24/pytorchenv/lib/python3.9/site-packages/fairscale/internal/reduce_scatter_bucketer.py:147: FutureWarning: `torch.distributed._reduce_scatter_base` is a private function and will be deprecated. Please use `torch.distributed.reduce_scatter_tensor` instead.
  dist._reduce_scatter_base(output, input_flattened, group=group)
Rank 0: [FairScaleFSDP] Epoch 50, Loss: 1.6321
Rank 0: [FairScaleFSDP] Total Training Time: 999.69s
Metrics saved to FairScaleFSDP_metrics.csv
Plots saved in 'plots' folder for mode FairScaleFSDP
